<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
		<link rel="icon" type="image/png" data-th-attr="href=@{/images/logo.png}">

		<title data-th-text="|myTasks - ${task.summary}|"></title>

		<!-- Bootstrap core CSS -->
		<link data-th-attr="href=@{/webjars/bootstrap/3.3.6/css/bootstrap.min.css}" rel="stylesheet">

		<!-- Custom styles for this template -->
		<link data-th-attr="href=@{/css/application.css}" rel="stylesheet">
		<link data-th-attr="href=@{/css/markdown.css}" rel="stylesheet">

		<script type="text/javascript">
		  function post(params) {
			  $.post(document.location, params, function() {location.reload();});
		  }
		</script> 
	</head>

	<body>

		<nav data-th-replace="fragments :: navbar"></nav>

		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div class="main">
						<div class="content">
							<h1 class="page-header" data-th-text="${task.summary}"></h1>
							<div class="btn-toolbar pull-right">
								<div class="btn-group" role="group">
									<button type="submit" class="btn btn-default" data-th-each="state : ${task.state.commonTransitions()}" data-th-text="#{|mytasks.state.transition.${task.state}.${state}|}" data-th-onclick="|post({state: '${state}', ${_csrf.parameterName}: '${_csrf.token}'});|"></button>
								</div>
								<div class="btn-group" role="group">
									<a role="button" class="btn btn-default" data-th-href="@{/tasks/edit/{taskId}(taskId=${task.id})}">
										<span class="glyphicon glyphicon-edit"></span>
									</a>
									<a role="button" class="btn btn-default" data-th-href="@{/tasks/delete/{taskId}(taskId=${task.id})}">
										<span class="glyphicon glyphicon-trash"></span>
									</a>
								</div>
							</div>
							<div>
								<span class="state" data-th-classappend="|state-${#strings.toLowerCase(task.state.name())}|" data-th-text="#{|mytasks.state.${task.state}|}"></span>
								<span class="priority" data-th-classappend="|priority-${#strings.toLowerCase(task.priority.name())}|"></span>
							</div>
							<div class="readme">
								<div class="markdown" data-th-if="${task.description}" data-th-utext="${@markdown.markdownToHtml(task.description)}">
								</div>
								<div data-th-unless="${task.description}">
									<a role="button" class="btn btn-primary" data-th-href="@{/tasks/edit/{taskId}/documentation(taskId=${task.id})}">
										Edit notes
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Bootstrap core JavaScript -->
		<script data-th-attr="src=@{/webjars/jquery/2.1.4/jquery.min.js}"></script>
		<script data-th-attr="src=@{/webjars/bootstrap/3.3.6/js/bootstrap.min.js}"></script>
	</body>
</html>

